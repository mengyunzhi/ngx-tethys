<div cdk-overlay-origin #origin="cdkOverlayOrigin" #trigger>
  <ng-container *ngIf="thyShowInput">
    <div
      thySelectControl
      [thySize]="thySize"
      [thyAllowClear]="true"
      (thyOnClear)="clearSelection($event)"
      [thyDisabled]="disabled"
      [thyIsMultiple]="thyMultiple"
      [thyPanelOpened]="menuVisible"
      [thySelectedOptions]="selected"
      [thyPlaceholder]="thyPlaceHolder"
      [customDisplayTemplate]="customDisplayTemplate"
    >
      <ng-template #customDisplayTemplate let-value>
        <span [ngClass]="labelCls">
          <ng-container *ngIf="!isLabelRenderTemplate; else labelTemplate">{{ value.labelText }}</ng-container>
          <ng-template #labelTemplate>
            <ng-template [ngTemplateOutlet]="thyLabelRender" [ngTemplateOutletContext]="value.labelRenderContext"></ng-template>
          </ng-template>
        </span>
      </ng-template>
    </div>
  </ng-container>
</div>

<ng-template
  cdkConnectedOverlay
  cdkConnectedOverlayHasBackdrop
  cdkConnectedOverlayBackdropClass="thy-cascader-backdrop"
  [cdkConnectedOverlayOrigin]="origin"
  [cdkConnectedOverlayPositions]="positions"
  (backdropClick)="closeMenu()"
  (detach)="closeMenu()"
  (positionChange)="onPositionChange($event)"
  [cdkConnectedOverlayOpen]="menuVisible"
>
  <div #menu [ngClass]="menuCls" [ngStyle]="thyMenuStyle" (mouseleave)="onMenuMouseleave($event)">
    <ul *ngFor="let options of thyColumns; let i = index" [ngClass]="menuColumnCls">
      <li
        thy-cascader-option
        *ngFor="let option of options"
        [option]="option"
        [multiple]="thyMultiple"
        (click)="onOptionClick(option, i, $event)"
        (mouseover)="onOptionMouseover(option, i, $event)"
        [thyLabelProperty]="thyLabelProperty"
        [active]="isActivedOption(option, i)"
      ></li>
    </ul>
  </div>
</ng-template>
